<div class="space-y-4 md:space-y-6">
  <!-- Título y botón Crear Rol -->
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 md:gap-4">
    <div class="flex-1 min-w-0">
      <h1 class="text-2xl md:text-3xl font-bold text-[var(--text-primary)] truncate">Roles y Permisos</h1>
      <p class="text-[var(--text-tertiary)] text-xs md:text-sm mt-1">Gestiona los roles y permisos de los usuarios del sistema</p>
    </div>
    <button
      (click)="createNewRole()"
      class="bg-purple-600 hover:bg-purple-700 text-white px-3 md:px-5 py-2.5 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 shadow-sm flex-shrink-0">
      <app-icon name="plus" class="w-5 h-5"></app-icon>
      <span class="hidden md:inline">Crear Rol</span>
    </button>
  </div>

  <!-- Tarjetas de estadísticas -->
  <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4 lg:gap-6">
    <!-- Total Roles -->
    <div class="bg-[var(--card-bg)] rounded-xl shadow-sm p-4 md:p-6 border border-[var(--card-border)]">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-xs md:text-sm font-medium text-[var(--text-tertiary)]">Total Roles</p>
          <p class="text-2xl md:text-3xl font-bold text-[var(--text-primary)] mt-2">{{ totalRoles }}</p>
        </div>
        <div class="p-2 md:p-3 rounded-lg">
          <app-icon name="shield" class="w-6 h-6 md:w-8 md:h-8 text-purple-600 dark:text-purple-400"></app-icon>
        </div>
      </div>
    </div>

    <!-- Roles Activos -->
    <div class="bg-[var(--card-bg)] rounded-xl shadow-sm p-4 md:p-6 border border-[var(--card-border)]">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-xs md:text-sm font-medium text-[var(--text-tertiary)]">Roles Activos</p>
          <p class="text-2xl md:text-3xl font-bold text-green-600 dark:text-green-400 mt-2">{{ rolesActivos }}</p>
        </div>
        <div class="p-2 md:p-3 rounded-lg">
          <app-icon name="shield" class="w-6 h-6 md:w-8 md:h-8 text-green-600 dark:text-green-400"></app-icon>
        </div>
      </div>
    </div>

    <!-- Permisos Totales -->
    <div class="bg-[var(--card-bg)] rounded-xl shadow-sm p-4 md:p-6 border border-[var(--card-border)]">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-xs md:text-sm font-medium text-[var(--text-tertiary)]">Permisos Totales</p>
          <p class="text-2xl md:text-3xl font-bold text-blue-600 dark:text-blue-400 mt-2">{{ permisosTotales }}</p>
        </div>
        <div class="p-2 md:p-3 rounded-lg">
          <app-icon name="shield" class="w-6 h-6 md:w-8 md:h-8 text-blue-600 dark:text-blue-400"></app-icon>
        </div>
      </div>
    </div>

    <!-- Usuarios con Roles -->
    <div class="bg-[var(--card-bg)] rounded-xl shadow-sm p-4 md:p-6 border border-[var(--card-border)]">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-xs md:text-sm font-medium text-[var(--text-tertiary)]">Usuarios con Roles</p>
          <p class="text-2xl md:text-3xl font-bold text-purple-600 dark:text-purple-400 mt-2">{{ usuariosConRoles }}</p>
        </div>
        <div class="p-2 md:p-3 rounded-lg">
          <app-icon name="shield" class="w-6 h-6 md:w-8 md:h-8 text-purple-600 dark:text-purple-400"></app-icon>
        </div>
      </div>
    </div>
  </div>

  <!-- Barra de búsqueda y filtros -->
  <div class="mb-4 md:mb-6">
    <app-search-filters
      searchPlaceholder="Buscar roles..."
      [filters]="filterConfigs"
      (onFilterChange)="onFilterChange($event)">
    </app-search-filters>
  </div>

  <!-- Tabla de roles -->
  @if (isLoading) {
    <app-skeleton-loader type="table" [rows]="5" [columns]="4"></app-skeleton-loader>
  } @else {
    <app-data-table
      [columns]="tableColumns"
      [data]="roles"
      [actions]="tableActions"
      (onActionClick)="handleTableAction($event)"
      (onViewMorePermissions)="handleViewMorePermissions($event)">
    </app-data-table>
  }

  <!-- Modal de permisos -->
  <app-permissions-modal
    [isOpen]="isPermissionsModalOpen"
    [permissions]="selectedPermissions"
    [roleName]="selectedRoleName"
    (onClose)="closePermissionsModal()">
  </app-permissions-modal>

  <!-- Modal de crear rol -->
  <app-dynamic-form-modal
    [isOpen]="isCreateRoleModalOpen"
    [mode]="'role'"
    [editMode]="false"
    (onClose)="closeCreateRoleModal()"
    (onSubmit)="handleCreateRole($event)">
  </app-dynamic-form-modal>

  <!-- Modal de editar rol -->
  <app-dynamic-form-modal
    [isOpen]="isEditRoleModalOpen"
    [mode]="'role'"
    [editMode]="true"
    [roleId]="editingRoleId"
    [initialData]="editingRoleData"
    (onClose)="closeEditRoleModal()"
    (onSubmit)="handleEditRole($event)">
  </app-dynamic-form-modal>

  <!-- Modal de ver rol -->
  <app-view-role-modal
    [isOpen]="isViewRoleModalOpen"
    [roleData]="viewingRoleData"
    (close)="closeViewRoleModal()">
  </app-view-role-modal>
</div>
